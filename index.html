<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>picloco | find local images  </title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  
<link rel="icon" type="image/ico" href="favicon.ico">

<link href='http://fonts.googleapis.com/css?family=Patua+One' rel='stylesheet' type='text/css'>

<!-- jquery -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> 

<!-- Mapbox.js API  -->
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css' rel='stylesheet' />

<!-- Font awesome -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

<!-- leaflet hash  -->
<script src='./js/leaflet-hash.js'></script>

<!-- Leaflet Locate -->
<script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.min.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.mapbox.css' rel='stylesheet' />
<!--[if lt IE 9]>
  <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.42.0/L.Control.Locate.ie.css' rel='stylesheet' />
<![endif]-->

<!-- <link rel="stylesheet" href="./css/simplemodal.css" type="text/css" media="screen" title="no title" charset="utf-8">
<script src="./js/simple-modal.js" type="text/javascript" charset="utf-8"></script> -->

<style>
body {background: #333; margin:0;padding:0;}
  * {-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;}
  h1 {font-size:22px;margin:0;font-weight:400;}
  a {
    color:#fff;
    text-decoration:none;
  }
  a:hover { color:#B9D4EE; }

  .footer {
    padding-top: 20px;
    color: #fff;
    position:absolute;
    width:100%;
    height:33%;
    bottom:0;
    text-align: center;
    font-family: 'Patua One', cursive;
  }
  .pad2 {
    padding:20px;
  }
  .quiet {
    color:#888;
  }
  .map {
    position:absolute;
    height: 66%;
    width:100%;
    top:0;bottom:0;
  }
  .listings {
    height:100%;
    overflow:auto;
    padding-bottom:60px;
  }
  .listings .item {
    position: relative;
    padding:10px;
    text-decoration:none;
  }
  .listings .item img {
    background: #fff;
    margin-bottom: 10px;
    width: 100%;
    text-align: center;
  }
  .listings .item .title {
    display:block;
  }
  .listings .item.active .title,
  .listings .item .title:hover { color:#8cc63f; }
  .listings .item.active {
    background-color:#f8f8f8;
  }
  ::-webkit-scrollbar {
    width:3px;
    height:3px;
    border-left:0;
    background:rgba(0,0,0,0.1);
  }
  ::-webkit-scrollbar-track {
    background:none;
  }
  ::-webkit-scrollbar-thumb {
    background:#FFE800;
    border-radius:0;
  }
  .clearfix { display:block; }
  .clearfix:after {
    content:'.';
    display:block;
    height:0;
    clear:both;
    visibility:hidden;
  }
  .trigger {
    color: #444;
    position: absolute;
    top: 6px;
    left: 70px;
    z-index: 10;
  }
  /*fa fa-location-arrow fa-2*/
  .leaflet-touch .leaflet-control-locate {
    width: 48px;
    height: 42px;
  }
  .fa-location-arrow {
    font-size: 30px;
  }
  .fa-spinner {
    font-size: 30px;
  }
  .leaflet-control-locate a {
    width: 42px;
    height: 38px;
  }
  .mapbox-maplogo {
      position:absolute;
      display:block;
      height: 20px;
      width: 65px;
      left:10px;
      bottom:10px;
      text-indent: -9999px;
      z-index:99999;
      overflow:hidden;
      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAAoCAMAAAAFWtJHAAAAwFBMVEUAAAAAAAAAAABtbW0AAAAAAAAAAAAAAAAAAAAAAAClpaUAAADp6ekAAAD5+fna2toAAAAMDAzv7+/Nzc0AAAA2Njb8/Pz9/f3T09MAAAAAAAD7+/sAAAArKyuxsbH39/fs7OwbGxuIiIjz8/N8fHyenp7u7u74+PgAAAC8vLxWVlbx8fF1dXXl5eVcXFyUlJTQ0NDFxcVCQkLAwMC4uLj19fXo6OjW1tarq6ve3t77+/vi4uL6+vrKysrNzc3///8w7gSSAAAAP3RSTlMAOQNdPSYBPywKexLLGPCxNEHXnzFL+v2nGwf1IEiE6dBFad9jd9PuLo1V2mDDV3Cjl06SiuXIq4C3973ym6BQMVUPAAAEXElEQVR4Ae2WCVP6OBiH05L0l1IqrVbkKHJ54I0oHn+PfP9vtUle0z/YdhbH2XVnd58ZnRJIeHiPJOx//mH4vQSAN+8FjAhFxgHIaPvJeZ99hxwEElon5iAQbj85Y98g8ODwjEOMAvGFyeE3FEKgodTBqj0BJGN9DhyNd5Ta3ean9QEopfaA+LsKhnEKRExqg4FSP6Og7oEkAjBWnxSCgBX4xF+kcLoPcOBQrSv0e5kH7s1j37jECQieCTPiFGxL5VHw2zQWCeeJiPt6kjRQw0XSkIdVChf67xGa4alSnZlT6HEQ8CK9ANbhvXUF9xlDkBfTuHDWScgC9+z5FQpPI12TlwC6+sV7ixR8CUMKiwjm2GQeOQWHMGuHGdbnObJAwCEqFJpNU5H6uaPUaEIKiQfg+PHk1+u4OwW9PlWW2ctbA4BHCtp+cNK+H8Jos4gDmC5ar4Nx9waaG/2B13NgDqS7+vm2RgEtEws82P+kwIHhs/pgkQKcFIhfd7CogtGNjYMHTLpurD0ERbYFw4JaD3GlQuNAL/JEsSAF4HqlCnaHACk4WhOn4OgCkMD5hSpYNYDJTD8Y46n+jsE1kPhVCuR6QBXhFK7MUOu9O6b1SWF3b+/9ZVWMGOlu93E8UDaAhgc7bfH+0DHqKXCkHzoNDFfU+zxiVQrUC9QXTuHYtKpN59OA3IxCG4b7jh6ZFuVockaNTW09mkJzOaPU49a6mE9cAchZpQJNpUWcwgV9r6FJswsFKrITp2B5pMBMdnS0z2HZNy2+BNKxSZxZfglkrFYBJxQnpzA5sN/HheR2aFQoZBLAi149dQoyAYYjW0hHlHguBAdMcR0DuDZ5omevX6+AI8qcU7ikKT3GBHCnXwydgmCC0tRwCnGQ2Wp6Be71yNIWfQSkOl9vAI1SBCNWrwC01RROgX7BuT2HI4r7tFAw086p/NwZEdOEa7R1uAFuNmQPuKAEAjYNQ0CyeoUEWHYBnpQVQgpvc0Ph+gsKlAnKg1+vEHsw5LKciLKCAJobiWBzYFGbCKpHqkZZrxBFHEASyFI59vJPCskcwNVGOWZAOqsrR+pKbaNeAMT1CixMEtlnsqopNxUMzVJT3tY35aXZm6a6Y9QhwMN6BUJWbE1lhbMO1WehkO7poO0sK7em9MJGxp1XSbC1gtugzzSLQmGsX7VntJGSwsPZ2d2z3bIPKzdoOp3Wzqt8G4XyMVUoFIxLx1S7+piaHtCvR3FeRVsq0GFdp9C5TbGpcNqsPqyHKxcfd14h21KhuLKUFU4f3osrC7F6uV3WXFnadL7wyAPeKDXw2RoJCO5GY4DouYvb/gepVXheLoewzPseQG9N/vzilrMIjoStE3++zvle4eSurw7XEe76ynI4aq+v7lEyt1x5awiFlFLQbHKIpabnM3eJLym4Szzzc/du7SU+zOXv9UNpECH7IoH/gecURPlN9vdQpeD47yhIFNX0U0QgvID9nENm+yxk/xb+AGAjNfRZuk9qAAAAAElFTkSuQmCC);
      background-repeat:no-repeat;
      background-position: 0 0 ;
      background-size: 65px 20px;
    }
  
  /*modal*/

  .modal-window {
    position:fixed;
    background-color: rgba(200,200,200,0.75);
    top:0;
    right:0;
    bottom:0;
    left:0;
    z-index:999;
    opacity:0;
    pointer-events:none;
    -webkit-transition:all 0.3s;
    -moz-transition:all 0.3s;
    transition:all 0.3s;
  }
  .modal-window a {
    color: #2A8FC3;
  }
  .modal-window:target {
    opacity:1;
    pointer-events:auto;
  }
  .modal-window>div {
    width:250px;
    position:relative;
    margin:10% auto;
    padding:2rem;
    background:#fff;
    color:#444;
  }
  .modal-window header {
    font-weight:bold;
  }
  .modal-close {
    color:#aaa;
    line-height:50px;
    font-size:80%;
    position:absolute;
    right:0;
    text-align:center;
    top:0;
    width:70px;
    text-decoration:none;
  }
  .modal-close:hover {
    color:#000;
  }
  .modal-window h1 {
    font-size: 150%;
    margin: 0 0 15px;
  }
  #open-modal {
    padding:20px;
    width: 
  }
</style>
</head>
<body>
<div>

<div id='map' class='map'>  <!-- Add mapbox watermark -->
  <a href="http://mapbox.com/about/maps" class='mapbox-maplogo' target="_blank">MapBox</a>
  <div id='camera' class='listings'><span class='trigger fa fa-camera-retro fa-4x'></span></div>
</div>
<div class='footer'>
  <div id='listings'></div>
  <a href="#open-modal">About</a>
  <div id="open-modal" class="modal-window">
      <div>
          <a href="#modal-close" title="Close" class="modal-close">Close</a>
       <h1><a href="https://github.com/geografa/picloco">piclo.co</a></h1>
       <div>
          <p>
            A little web app that combines the <a href="https://www.mapbox.com/mapbox.js/">Mapbox.js API</a> with location information stored with <a href="https://instagram.com/developer/">Instagram's API</a>. Click the <br /><span class="fa fa-camera-retro fa-2x"></span> <br />camera icon to load publicly shared images within 80 meters of the map's center. Click the <br /><span class=" fa fa-location-arrow fa-2x"></span><br /> arrow to locate your own position.
          </p>
       </div>
      </div>
  </div>
</div>

</div>
<script>

// get your access token from https://www.mapbox.com/signup/
L.mapbox.accessToken = 'pk.eyJ1IjoidHJpc3RlbiIsImEiOiJiUzBYOEJzIn0.VyXs9qNWgTfABLzSI3YcrQ';

// Make a custom map with Mapbox Studio https://www.mapbox.com/mapbox-studio/ 
var map = L.mapbox.map('map', 'grafa.m8p63n24',{
  zoomControl:false,
  maxZoom: 17
})
    .setView([40.78060642427845,-73.96661281585693], 13);

L.control.locate({
  icon: 'fa fa-location-arrow'
}).addTo(map);

var hash = new L.Hash(map);

//click the camera icon to load IG images
$('#camera').on('click', '.trigger', function() {
    // get IG tokens from https://instagram.com/developer/clients/manage/
    var accessToken = 'fa7735431203415882fa980bd386baca';
    var lat = map.getCenter('features').lat,
        lng = map.getCenter('features').lng

    $.ajax({
        // distance in meters
        url: 'https://api.instagram.com/v1/media/search?lat=' + lat + '&lng=' + lng + '&distance=80',
        dataType: 'jsonp',
        type: 'GET',
        data: {client_id: accessToken},
        success: function(data){
            console.log(data);

            var listing = listings.appendChild(document.createElement('div'));
            $("div").remove(".item");

            for(x in data.data){
              listing.className = 'item';

              var link = listing.appendChild(document.createElement('a'));
              link.href = '#';
              link.className = 'title';
              link.innerHTML = '<a href="http://instagram.com/' +data.data[x].user.username+ '" target="_blank"><img src="'+data.data[x].images.low_resolution.url+'" class="listing item"></a>';
            }
        }
    });
    show('toplink');
});

// twitter
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');

// google-analytics
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-63336541-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>